
**Дата:** 20 сентября 2023 г.

**Статус:** Принято

**Контекст:**

Для сервиса парковки требуется выбрать системы хранения данных, которые обеспечат надежность, производительность и масштабируемость для различных типов данных: транзакционные данные пользователей, информация о парковочных местах в реальном времени, история транзакций и аналитические данные.

**Рассмотренные варианты:**

1. **PostgreSQL:** Надежная реляционная СУБД с поддержкой транзакций ACID.
2. **MongoDB:** Документоориентированная NoSQL база данных с горизонтальным масштабированием.
3. **Redis:** In-memory структуры данных для кэширования и работы с реальным временем.
4. **Cassandra:** Распределенная NoSQL база данных с высокой доступностью и масштабируемостью.

**Решение:**

Принята комбинированная стратегия использования нескольких систем хранения:

- PostgreSQL - для транзакционных данных (пользователи, бронирования, платежи)
- Redis - для кэширования и хранения состояния парковочных мест в реальном времени
- TimescaleDB (расширение PostgreSQL) - для временных рядов и аналитики

**Обоснование:**

- **Надежность транзакций:** PostgreSQL гарантирует целостность критических данных (платежи, бронирования) через ACID-транзакции.
- **Производительность в реальном времени:** Redis обеспечивает миллисекундное время отклика для обновления статуса парковочных мест и кэширования частых запросов.
- **Аналитика и отчетность:** TimescaleDB оптимизирована для временных рядов, что идеально подходит для сбора статистики использования парковок.
- **Гибкость:** Комбинированный подход позволяет использовать каждую СУБД для наиболее подходящих задач.
- **JSON поддержка в PostgreSQL:** Позволяет гибко хранить дополнительные атрибуты парковок и пользовательских данных.
  
**Последствия:**

- Разные микросервисы будут использовать различные системы хранения в зависимости от их потребностей.
- Необходимо реализовать стратегию синхронизации данных между разными СУБД где это требуется.
- Требуется обеспечить экспертизу команды в работе с выбранными системами хранения.
- Необходимо настроить репликацию и резервное копирование для каждой из систем хранения.
- Следует мониторить производительность каждой СУБД и оптимизировать запросы соответственно.
